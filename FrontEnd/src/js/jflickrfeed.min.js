function calcularIndice(e,t){var a;for(i=0;;i++)if(a=Math.floor(Math.random()*e),$.inArray(a,usados)<0){usados.push(a);break}return a}var usados=new Array;!function(e){e.fn.jflickrfeed=function(i,t){i=e.extend(!0,{flickrbase:"https://api.flickr.com/services/feeds/",feedapi:"photoset.gne",limit:20,qstrings:{lang:"en-us",format:"json",jsoncallback:"?"},cleanDescription:!0,useTemplate:!0,itemTemplate:"",itemCallback:function(){}},i);var a=i.flickrbase+i.feedapi+"?",m=!0;for(var r in i.qstrings)m||(a+="&"),a+=r+"="+i.qstrings[r],m=!1;return e(this).each(function(){var m=e(this),r=this;e.getJSON(a,function(a){var c="",n=a.items.length,s=i.limit,l=20;s&&(l=s),n<i.limit&&(s=n),l>n&&(l=n);for(var o=0;s>o;o++){var p=calcularIndice(l,c),d=p;if(item=a.items[d],void 0!=item){if(i.cleanDescription){var f=/<p>(.*?)<\/p>/g,u="";void 0!=item.description&&(u=item.description,f.test(u)&&(item.description=u.match(f)[2],void 0!=item.description&&(item.description=item.description.replace("<p>","").replace("</p>",""))))}if(item.image_s=item.media.m.replace("_m","_s"),item.image_t=item.media.m.replace("_m","_t"),item.image_m=item.media.m.replace("_m","_m"),item.image=item.media.m.replace("_m",""),item.image_b=item.media.m.replace("_m","_b"),item.image_q=item.media.m.replace("_m","_q"),delete item.media,i.useTemplate){var g=i.itemTemplate;for(var v in item){var _=new RegExp("{{"+v+"}}","g");g=g.replace(_,item[v])}m.append(g)}i.itemCallback.call(r,item)}}e.isFunction(t)&&t.call(r,a)})})}}(jQuery);